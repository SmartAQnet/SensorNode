<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SMARTAQNET-STATIONARY: Smart Air Quality Network (SMARTAQNET)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="monogram.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="monogram.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SMARTAQNET-STATIONARY
   </div>
   <div id="projectbrief">Smart Air Quality Network Crowdsensor Firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Smart Air Quality Network (SMARTAQNET) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>SMARTAQNET project is aimed at development of a close-meshed network of local fine-dust data, which can be fed and used well by general public. Further details can be checked at: <a href="http://www.smartaq.net">http://www.smartaq.net</a>.<br />
 This script uses a ESP32 HELTEC Board, a SDS011 particulate matter sensor and a BME280 sensor or a DHT22 sensor. The <a class="el" href="index.html#Fig-1">Fig-1</a> shows the main board having different sensors connected together. The ESP32 is also refered to as crowdsensor. After power on, it opens a Wifi access point, default Password is 12345678. The Wifi access point can be searched by a device (Smartphone, Tablet, Laptop or similar) using the ID shown on the OLED display. A webpage (also called "Captive Portal") opens after connection to this AP with Smartphone. If no webpage is opening automatically, it can be opend by typing "http://192.168.244.1" into the browser. By using this webpage, the crowdsensor can be connected to any of the available Wifi networks. The crowdsensors configuration page can then be accessed using <a href="http://">http://</a>[localIP]/ or using <a href="http://">http://</a>[SSD-ID].local/ e.g., <a href="http://192.168.0.39">http://192.168.0.39</a> or <a href="http://181712.local">http://181712.local</a>. The local IP and the SSD-ID are both printed on the screen of the crowd sensor. The location address, the thermal sensor type, the ID of the dust sensor SDS011, the owner of the data and more can be configure using the configuration page. The firware version of the code is hard-coded by the constant (<a class="el" href="main_8h.html#aa14dc39d52ab121ceb570f1a265385e0" title="firmware version, (for intermediate versions being actively worked on, append &quot;pre&quot; to number,...">FIRMWARE_VERSION</a>). The detailed debugging can be controlled for the firmware using the constant RELEASE. Following is the details for differnt features and steps to start:<br />
</p><ul>
<li>Install the arduino, board and required libraies as explained in <a class="el" href="index.html#arduinoide">Arduino IDE</a>, <a class="el" href="index.html#boardlib">ESP32 Arduino core</a>, <a class="el" href="index.html#lib">Required Libraries</a></li>
<li>Connect the hardware as explained in <a class="el" href="index.html#wiring">Wirings</a>, <a class="el" href="index.html#hw_sec">Hardware</a> and <a class="el" href="index.html#peri">Peripherals</a></li>
<li>Configure the constants in the code as explained in <a class="el" href="index.html#const">Important Constants</a>.</li>
<li>Compile and upload the cdes as explained in <a class="el" href="index.html#upload">Firmware Uploading</a> and <a class="el" href="index.html#dialout">Pyserial</a></li>
<li>Configure the WiFi and other parameters as explained in <a class="el" href="index.html#wifi">WiFi USage</a> and <a class="el" href="index.html#configpage">Configuration Page</a></li>
<li>If everything is installed and configured perfectly, there should be no error i.e., E0 as explained in <a class="el" href="index.html#errorenc">Error Decoding</a></li>
<li>If there is any errors please look into error or known bug section as explained in <a class="el" href="index.html#errorenc">Error Decoding</a> and <a class="el" href="index.html#knownbugs">Known Bugs</a></li>
<li>For detailed debugging uncomment RELEASE constant. Some quick trick will also save the time as shown in <a class="el" href="index.html#deb">Quick Debugging</a> <a class="anchor" id="Fig-1"></a> <div class="image">
<img src="board.png" alt="board.png" width="500px"/>
<div class="caption">
Figure 1. Sensor Board</div></div>
  </li>
</ul>
<h2><a class="anchor" id="oled"></a>
OLED Display Usage</h2>
<p>Built-in OLED, a SSD1306 based display, is used to display different type of information, messages, images and QR code. The display is connected using I2C interface using u8g2 library.</p><ul>
<li>Hardware PINs: <a class="el" href="main_8h.html#ac5d957e4fd3dc11cd97a54cf9ca057a4" title="Reset PIN of OLED Module.">RST</a> (16) is reset, <a class="el" href="main_8h.html#afbf31d4d5bad7fd61418b8b8036df96c" title="The SDA pin of the SSD1306 OLDE.">OLED_SDA</a> (4) is SDA and <a class="el" href="main_8h.html#ad3ddbbb48cad4c34406916e199b89122" title="The SCL pin of the SSD1306 OLDE.">OLED_SCL</a> (15) is SCL pin of the display and <a class="el" href="main_8h.html#a7dfa2c4cfbfcba36416046052e7943e8" title="The I2C address of the SSD1306 OLDE.">OLED_ADDR</a> (0x3c) is the I2C address of the display.</li>
<li>ICONS and QR Codes: at the startup it displays logos and then a QR code</li>
<li>Which Screens to display and their meaning: There are two main screens. The <a class="el" href="index.html#Fig-2">Fig-2</a> shows the main screen while the <a class="el" href="index.html#Fig-3">Fig-3</a> shows second screen. During the execution, different screens are:<ol type="1">
<li>When the firmware is started, OLED displays and it tries to search the previous configured WiFi as in <a class="el" href="index.html#Fig-2">Fig-2</a>. The last line shows the hardware ID of the ESP32. <a class="anchor" id="Fig-2"></a> <div class="image">
<img src="searchwifi.png" alt="searchwifi.png" width="300px"/>
<div class="caption">
Figure 2. OLED Display: Searching Wifi</div></div>
 </li>
<li>When the firmware could not find previous WiFi, it opens an AP and shows the screen as in <a class="el" href="index.html#Fig-3">Fig-3</a>. It shows the SSID and Password for AP and its IP address. <a class="anchor" id="Fig-3"></a> <div class="image">
<img src="apmode.png" alt="apmode.png" width="300px"/>
<div class="caption">
Figure 3. OLED Display: Access Point WiFi</div></div>
 </li>
<li>When the WiFi is connected, it shows that it is waiting for the time to be synchronized, as in <a class="el" href="index.html#Fig-4">Fig-4</a>. <a class="anchor" id="Fig-4"></a> <div class="image">
<img src="syncwait.png" alt="syncwait.png" width="300px"/>
<div class="caption">
Figure 4. OLED Display: NTP Time Sync</div></div>
 </li>
<li>When the WiFi is connected, temperature and dust sensor are attached and configured, the screen in <a class="el" href="index.html#Fig-5">Fig-5</a> shows the sensed values, ID and static IP of the ESP32. ER shows the error code in hexadecimal. This is explained in the section below. ER of 0xC0 means the dust and temperature sensors are not connected. <a class="anchor" id="Fig-5"></a> <div class="image">
<img src="screen1.png" alt="screen1.png" width="300px"/>
<div class="caption">
Figure 5. OLED Display Screen-1</div></div>
 </li>
<li>When the WiFi is connected, temperature and dust sensor are not attached, the screen in <a class="el" href="index.html#Fig-6">Fig-6</a> shows the messages (i.e., FEINSTAUBSENSOR:Bitte verbinden and TEMPERATURSENSOR:Bitte verbinden, ID and static IP of the ESP32. When temperature and dust sensor are attached but temperature is not configured, screen shows the messages FEINSTAUBSENSOR:Bitte verbinden and TEMPERATURSENSOR:Bitte auswaehlen. <a class="anchor" id="Fig-6"></a> <div class="image">
<img src="screen1error.png" alt="screen1error.png" width="300px"/>
<div class="caption">
Figure 6. OLED Display: Screen-1 Error</div></div>
 </li>
<li>When the WiFi is not connected or it is disconnected or time is not synchronized during the second trial, <a class="el" href="index.html#Fig-7">Fig-7</a>, shows the messages and ID of the ESP32. And it restarts. <a class="anchor" id="Fig-7"></a> <div class="image">
<img src="reboot.png" alt="reboot.png" width="300px"/>
<div class="caption">
Figure 7. OLED Display: WiFi or NTP Error</div></div>
 </li>
<li>The <a class="el" href="index.html#Fig-8">Fig-8</a> screen shows some statistical and informative messages, with the intervals of (<a class="el" href="main_8h.html#a71a7a65f7dd7e8f3ea14942213cd8217" title="intervall of reading sensor data in ms">SENSOR_INTERVAL</a>) in non-release mode. <a class="anchor" id="Fig-8"></a> <div class="image">
<img src="screen2.png" alt="screen2.png" width="300px"/>
<div class="caption">
Figure 8. OLED Display: Screen-2</div></div>
  The statistical screen contains the following. These are tentative, we can change the words and information.<ol type="a">
<li><b>Reboot</b> is indicating the total number of reboots. This will help us how many normal boots (@4AM) and how many accidental boots happened? Saved in the eeprom.</li>
<li><b>Obsert</b> is the total number of the observations since the beginning. Saved in the eeprom.</li>
<li><b>Misses</b> is the total number of the observations that are not posted correctly i.e., negative HTTP status codes. Saved in the eeprom.</li>
<li><b>E</b> (i.e. Errors) is the encoding of the errors in hexadecimal. (see below). Not saved in the eeprom.</li>
<li><b>Begins</b> is the timestamp of the first observation at the time entities were created for the first time. Saved in the eeprom.<br />
</li>
</ol>
</li>
<li>The QR screen is show at two occasions. First when there is no wifi configured and ESP32 opens an AP, it shows a screen (<a class="el" href="index.html#Fig-3">Fig-3</a>) and a QR code alternatively with an interval of <a class="el" href="my_auto_connect_8h.html#aaba24da06a6518ece5c17ddc6f952e22" title="The interval to show QR or AP waiting screen (in ms)">SHOW_QR_INTERVAL</a>. Other screen after the WiFi is configured, is continuously with the text (<a class="el" href="index.html#Fig-5">Fig-5</a>) of and QR code with an interval of <a class="el" href="main_8h.html#a71a7a65f7dd7e8f3ea14942213cd8217" title="intervall of reading sensor data in ms">SENSOR_INTERVAL</a>.</li>
</ol>
</li>
</ul>
<h2><a class="anchor" id="errorenc"></a>
Error Decoding</h2>
<p>On the last line of the display, at the right most column indicated the different errors which are encoded in hexadecimal. If there is any error, corresponding bit is set to high. The error encoding is explained below in the Table <a class="el" href="index.html#Tab-1">Tab-1</a>: </p><center> <a class="anchor" id="Tab-1"></a>
<table class="doxtable">
<caption>Error Enconding</caption>
<tr>
<th>Bit <br />
 Location </th><th>7 </th><th>6 </th><th>5 </th><th>4 </th><th>3 </th><th>2 </th><th>1 </th><th>0 </th></tr>
<tr>
<td>Error <br />
 Type </td><td>SDS <br />
 HW <br />
 Error </td><td>BME <br />
 HW <br />
 Error </td><td>BME <br />
 Select <br />
 Error </td><td>NTP <br />
 First <br />
 Error </td><td>mDNS <br />
 Error </td><td>Create <br />
 Entities <br />
 Error </td><td>Location <br />
 Missing <br />
 Error </td><td>HTTP <br />
 Server <br />
 Error </td></tr>
</table>
</center><ol type="1">
<li><b>E00</b> indicates "NO ERROR".</li>
<li><b>E01</b> indicates "HTTP Server Error", this happens when the HTTP Server is not responding.</li>
<li><b>E02</b> indicates "Location Missing Error", this happens when the location is not configured on the configuration page.</li>
<li><b>E04</b> indicates "Create Entities Error", this happens when the entities are not created properly.</li>
<li><b>E08</b> indicates "mDNS Error", this happens when the mDNS has not started properly.</li>
<li><b>E10</b> indicates "NTP First Error", this happens when the time is not sync for the first time.</li>
<li><b>E20</b> indicates "BME Select ERROR", this happens when the Temperature sensor is not configured from the configuration page.</li>
<li><b>E40</b> indicates "BME HW ERROR", this happens when the Temperature sensor is not connected.</li>
<li><b>E80</b> indicates "SDS HW ERROR", this happens when the dust sensor is not given.<br />
 There might b combination of above errors, for Example:<ol type="a">
<li>Error E03 means: The comobination of E01 and E02.</li>
<li>Error E21 means: The temperature sensor is not selected and the location is not configured.</li>
<li>Error E01 means: There is a HTTP Server error.</li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="nvs"></a>
Non-Volatile Storage (NVS) Usage</h2>
<p>NVS flash storage is used to save different information permanently. It saves latitude as "latitude", longitude as "longitude", SDS011 ID as "sds011id", human readable location as "address" license name as "data_license, license legal notice as "data_owner", license url as "data_url", error codes as "warning",  starting timestamp as "tom", total number of observations posted as "tObservation",
 total number of errorneous observations as "nObservation", total number of reset counter as "rCounter". The configurational parameteres are updated in the nvs when there is change from HTML configuration page, while the statistical parameters are updated during different execution scenarios. </p>
<h2><a class="anchor" id="sdso11"></a>
SDS011 Dust Sensor Usage</h2>
<ul>
<li>Hardware Pins: it uses transmit <a class="el" href="sensor_8h.html#a7130f8006502cdaa31094baa3f4dd3fa" title="SDS011 TXD pin is connected at RXD of Serial2 Object.">SDS011_TXD</a> (13) and recieve <a class="el" href="sensor_8h.html#ad2b404eb4de525cef31b8413f5d14b13" title="SDS011 RXD pin is connected at TXD of Serial2 Object (no need to physically connect)">SDS011_RXD</a> (17) pins</li>
<li>SERIAL Port: it uses the HardwareSerial port 2 for <a class="el" href="sensor_8h.html#a8f7824c0f2a3aa7e9bac94eac190fa7e" title="use Serial 2 Object">SDS_SERIAL</a> </li>
</ul>
<h2><a class="anchor" id="bme280"></a>
BME280 Sensor Usage</h2>
<ul>
<li>Hardware Pins: it uses SDA <a class="el" href="sensor_8h.html#ad9e594e426bce833af06dea308dbbf9a" title="BME280 I2C SDA pin.">BME_SDA</a> (21) and SCL <a class="el" href="sensor_8h.html#a5db75d8e5f3deda546603b949c520446" title="BME280 I2C SCL pin.">BME_SCL</a> (22) pins</li>
<li>I2C Port: to avoid any mismatch it uses Wire1 (default is Wire0) in bme.begin(BME_ADDR, &amp;Wire1)</li>
<li>I2C address: <a class="el" href="sensor_8h.html#a9f6149e98e70e1d5be5f0f33921cb7d7" title="BME280 I2C Address 0x77 for Red, 0x76 for Purple (chinese)">BME_ADDR</a> as 0x77 for Red, 0x76 for Purple (chinese)</li>
</ul>
<h2><a class="anchor" id="wifi"></a>
WiFi USage</h2>
<p>Firstly, on power up ESP32 tries to connect to earlier configured WiFi untill (<a class="el" href="my_auto_connect_8h.html#ab8e5b92436ed19ff04454974ca9b5140" title="Timeout to search WiFi already configured. (150000ms=2.5min)">WIFI_REBOOT_TIMEOUT</a>), if not found it opens up a new access point. Any client can be connected using SSID and Passcode shown on the screen. If some connects to access point a configuration pages is automatically opened, if not, one can open it using <a href="http://">http://</a>[localIP]/ or using <a href="http://">http://</a>[SSD-ID].local/. Using this configuration page, any avaialable WiFi arround you can be connected with using respective credentials. The ESP32 waits for some client to be connected untill (<a class="el" href="main_8h.html#a8a1756fdd61bca61d188ce01ece876b9" title="intervall of auto reboot while in access point mode (config mode) in ms (600000ms is 10min)....">APMODE_REBOOT_TIMEOUT</a>), otherwise it will restart and repeate the process. If some client is connected within timeout, ESP32 tries to synchronised with the network time untill (<a class="el" href="main_8h.html#ad8124687637087b9096f96b838f93400" title="Timeout for NTP timeout (s) in waitForSync()">NTP_TIMEOUT_WAIT</a>), otherwise it skips this synchronization for the second trial later. Later, before creating server entities it tries to synchronised with the network time untill (<a class="el" href="main_8h.html#ad8124687637087b9096f96b838f93400" title="Timeout for NTP timeout (s) in waitForSync()">NTP_TIMEOUT_WAIT</a>) and restart if not seccessful.</p>
<h2><a class="anchor" id="configpage"></a>
Configuration Page</h2>
<p>A HTML configuration page is prepared using AutoConnect library without using Pagebuilder library. Different elements are defined like: cfgtitle (ACText), cfgScript (ACElement), cfgBody (ACElement), cfgData (ACText), cfgBody2 (ACElement) which are combined using AutoConnectAux. The function <a class="el" href="main_8h.html#a26b99cccf6c7e87054577b293e709733" title="Function to handle the http://[IPAddress]/config response of Webserver::on(...) after button submissi...">handleConfig()</a> is used to handle the "/config" response of Webserver::on(...) after button submission, the function <a class="el" href="main_8h.html#ad9a1e86fe8a8ccdeddbd435307dc8b9c" title="Function to handle the http://[IPAddress]/ response of AutoConnect::on(...)">handleRoot()</a> is used to handle the / response of AutoConnect::on(...), the function <a class="el" href="main_8h.html#adb1e5699d1d537b00a661d58f303b8c0" title="Function to handle the http://[IPAddress]/otaUpdate HTTP_POST response of Webserver::on(....">otaUpdateHandler()</a> is used to handle the /otaUpdate HTTP_POST response of Webserver::on(...), the function <a class="el" href="main_8h.html#ac18409cbc727fcbb81831d42abceffc2" title="Function to handle the http://[IPAddress]/update HTTP_POST response of Webserver::on(....">updateHandler()</a> is used to handle the /update HTTP_POST response of Webserver::on(...), the function <a class="el" href="main_8h.html#a27d0e99a6ba203be7c65cd32285853c2" title="Function to handle the http://[IPAddress]/update HTTP_GET response of Webserver::on(....">updateHandlerResponse()</a> is used to handle the /update HTTP_GET response of Webserver::on(...). HTML script otaUpdate defines OTA uploading webpage using AutoConnectAux. The HTML configuration element "inputAddress" defines to input the human readable address, "inputLon" defines to input location's longitude, "inputLat" defines to input location's latitude, "inputRhtsensor" defines to select the temperature sensor out of "default", "BME280" and "DHT22"; "inputSds011id" defines to input the printed SDS011 serial number, "inputLicense" defines to select license type between "CC0 1.0" or "CC BY 4.0" and "inputOwner" defines to input the legal_notice of the license owner. The license "CC0 1.0" and "CC BY 4.0" points to " #data1_url_cc0 " and " #data1_url_ccby " respectively.<br />
 The <a class="el" href="index.html#Fig-9">Fig-9</a> shows an example fo a configuration page. The configuration page has following information from top-bottom:</p><ol type="1">
<li><b>Menus</b>: There are different menues which performs different actions</li>
<li><b>Title</b>: It indicates the title of page and the firmware version.</li>
<li><b>Map</b>: It indicates the google map of the location selected. Or you can choose any location from this map using the the cursor.</li>
<li><b>Address</b>: One can input the human readable address for the location.</li>
<li><b>Longitude</b>: One can input the longitude of the location.</li>
<li><b>Latitude</b>: One can input the latitude of the location.</li>
<li><b>Sensors</b>: One can chose the temperature sensor i.e., none, BME22, or DHT22.</li>
<li><b>SDS011 ID</b>: One can input the hard-coded serial number from the sds011 dust sensor.</li>
<li><b>Licese Name</b>: One can chose the license type here.</li>
<li><b>Legal Notice</b>: One can chose the license owner of the data.</li>
<li><b>Submit (Speichern)</b>: Button to submit the new configuration to ESP32, which will reset it and new entities will be created again.</li>
</ol>
<p>The menu has the following items:</p><ol type="1">
<li><b>HOME</b>: is the home of the configuration page. It shows the different parameters of the current connection.</li>
<li><b>Update</b>: is used to update the firmware over OTA.</li>
<li><b>Configure</b>: is the configuration page as shown in <a class="el" href="index.html#Fig-9">Fig-9</a>.</li>
<li><b>Reset...</b>: this will reset the board.</li>
<li><b>Disconnect</b>: will disconnect the system from the current WiFi.</li>
<li><b>Open SSIDs</b>: shows all the used/configured WiFi SSIDs.</li>
<li><b>Configure new AP</b>: used to connect to a new WiFi. There it show all the available WiFi routers and one can connect to one having SSID and Password.<br />
 <b>Note: The config page sometimes takes quite long to load (esp. on a mobile phone). Patience needed!!!</b> <div style="page-break-after: always"></div> <a class="anchor" id="Fig-9"></a> <div class="image">
<img src="configr.png" alt="configr.png" width="700px"/>
<div class="caption">
Figure 9. Configuration Page</div></div>
 </li>
</ol>
<h2><a class="anchor" id="mdns"></a>
MDNS</h2>
<p>A domain name service is used instead of typing IP. It is configure according to hardware ID of ESP32. One can open configuration page using <a href="http://">http://</a>[ID].local/.</p>
<h2><a class="anchor" id="dailyreboot"></a>
Daily Reboot</h2>
<p>There is a daily reboot at time defined by (<a class="el" href="main_8h.html#a423126ae538bf9e83239e46e46cf1df9" title="set time when to do daily reboot (hour of time of day for reboot goes here) //TODO set proper time">TIMETOREBOOT</a>) if it is enabled by (<a class="el" href="main_8h.html#a18bdfe88e9f5895863740df7ad801109" title="enable daily reboot at specific time">ENABLE_DAILY_REBOOT</a>). This is incoporated as a precaution.</p>
<h2><a class="anchor" id="intervals"></a>
Sensing and Sending Intervals</h2>
<p>The temperature and dust values are sensed at an interval of (<a class="el" href="main_8h.html#aef6021251fa63b1e73a98864b809904e" title="intervall of showing statistics informations, it is multiple of SENSOR_INTERVAL i....">STATS_INTERVAL</a>), and posted at the interval of (<a class="el" href="main_8h.html#aef6021251fa63b1e73a98864b809904e" title="intervall of showing statistics informations, it is multiple of SENSOR_INTERVAL i....">STATS_INTERVAL</a>) if HTTP server is available, location data is given and if the server entities are created seccessfully. The sensed values are also sent to madavi and send2luftdaten servers at the interval of (SEND2MADAVI_INTERVAL) and the interval of (<a class="el" href="main_8h.html#a7a63477c73052322ebb3ea6f1bfe7e1d" title="intervall of sending to madavi api in ms">SEND2LUFTDATEN_INTERVAL</a>), if (<a class="el" href="main_8h.html#a18d121e3e45bfea386799ad36fb70b5f" title="switch for sending to madavi api">ENABLE_SEND2MADAVI</a>) and (<a class="el" href="main_8h.html#ace6bf58c74189bcd567c1135baaa9505" title="switch for sending to luftdaten api">ENABLE_SEND2LUFTDATEN</a>) is enabled respectively. </p>
<h2><a class="anchor" id="create"></a>
Modelling and Creating Entities</h2>
<p>Before posting the observations of dust and temperature sensors, different type of entities need to be created on the server using HTTP methods. Usually, the the entities which are created consists of: Thing, Sensor, Location, Obervedproperty, Datastream and Observation. The nomenclature used for the creation can be seen in the presentation <a href="modelling.pdf" target="_blank"><b>Modelling the SmartAQnet Database</b></a>. Some of the entities are created from scratch, while some are only patched if already exist. For example, the "Thing" is patched with location and properties. The "Datastream" is alse needs to be patched with the properties. The sequence of the creation of different entities and how they are patched with required location and/or properties can be seen in the flowchart <a href="CreateEntitiesFlow.pdf" target="_blank"><b>Create Server Entities Flow</b></a>. Entities are created using particular JSON messages which are transmitted using HTTP methods. The seccessfull creation indicates only the status code of 200 and 201, and based on this a boolean response is returned. The observations are then posted at the interval of (<a class="el" href="main_8h.html#aef6021251fa63b1e73a98864b809904e" title="intervall of showing statistics informations, it is multiple of SENSOR_INTERVAL i....">STATS_INTERVAL</a>) and if (<a class="el" href="main_8h.html#af58473239b566ebd1187b4cc8c71e97d" title="switch for sending to FROST teco server">ENABLE_SEND2FROST</a>) is enabled. The Software property version can be controlled by the constant (<a class="el" href="main_8h.html#af06baee05280c189592215d5ea08e7ef" title="Software.version Name property for Thing and Datastreams.">sw_version</a>) and timestamp is assign on the fly, while the harware revision date is controlled by using the constant (<a class="el" href="main_8h.html#acbd8a4cec684c263a6cc312c70d45ef3" title="Hardware.Revision Date property for Thing and Datastreams.">hw_date</a>).<br />
 The Table <a class="el" href="index.html#Tab-2">Tab-2</a> shows which entities are to be created and which entities are patched? The entities are created if they does not exist and patched with different properties if they already exist.</p>
<div style="page-break-after: always"></div> <center> <a class="anchor" id="Tab-2"></a>
<table class="doxtable">
<caption>Entities Creation &amp; Patching</caption>
<tr>
<th>Entity </th><th>Type </th><th>Patched? </th><th>Patched With? </th></tr>
<tr>
<td>Thing </td><td>None </td><td>Yes </td><td>Location, Software Version </td></tr>
<tr>
<td>Location </td><td>None </td><td>No </td><td>None </td></tr>
<tr>
<td rowspan="3">Sensor </td><td>SDS011 </td><td>No </td><td>None </td></tr>
<tr>
<td>BME280 </td><td>No </td><td>None </td></tr>
<tr>
<td>DHT22 </td><td>No </td><td>None </td></tr>
<tr>
<td rowspan="5">Observed Properties </td><td>PM2.5 </td><td>No </td><td>None </td></tr>
<tr>
<td>PM10 </td><td>No </td><td>None </td></tr>
<tr>
<td>Temperature </td><td>No </td><td>None </td></tr>
<tr>
<td>Pressure </td><td>No </td><td>None </td></tr>
<tr>
<td>Humidity </td><td>No </td><td>None </td></tr>
<tr>
<td rowspan="5">Observations </td><td>PM2.5 </td><td>No </td><td>None </td></tr>
<tr>
<td>PM10 </td><td>No </td><td>None </td></tr>
<tr>
<td>Temperature </td><td>No </td><td>None </td></tr>
<tr>
<td>Pressure </td><td>No </td><td>None </td></tr>
<tr>
<td>Humidity </td><td>No </td><td>None </td></tr>
<tr>
<td rowspan="5">Datastreams </td><td>PM2.5 </td><td>Yes </td><td>Software Version, License </td></tr>
<tr>
<td>PM10 </td><td>Yes </td><td>Software Version, License </td></tr>
<tr>
<td>Temperature </td><td>Yes </td><td>Software Version, License </td></tr>
<tr>
<td>Pressure </td><td>Yes </td><td>Software Version, License </td></tr>
<tr>
<td>Humidity </td><td>Yes </td><td>Software Version, License </td></tr>
</table>
</center><h2><a class="anchor" id="flowchart"></a>
FlowCharts</h2>
<p>The project work-flow can be see in the <a href="StatemachineFlow.pdf" target="_blank"><b>flowchart</b></a>. Also there is a another flowchart and explanation regarding "Inside AutoConnect::begin" function at <a href="https://hieromon.github.io/AutoConnect/lsbegin.html">https://hieromon.github.io/AutoConnect/lsbegin.html</a> .<br />
 There is a another flowchart and explanation regarding creating &amp; patching different SAQN Database Entities on the server using JSON messages, as shown in <a href="CreateEntitiesFlow.pdf" target="_blank"><b>Create Server Entities Flow</b></a>.<br />
 There creation of entities implements OGC like API i.e. <a href="https://developers.sensorup.com/docs/#sensorthingsAPISensing">https://developers.sensorup.com/docs/#sensorthingsAPISensing</a>).<br />
</p>
<h2><a class="anchor" id="const"></a>
Important Constants</h2>
<p>Have a look at the following constants to configure them accordingly. These constants needs to be configured before the firmware is uploaded.</p><ul>
<li>in the file <a class="el" href="my_auto_connect_8h.html" title="Inherits the AutoConnect class and overrides few functions.">myAutoConnect.h</a><ul>
<li><a class="el" href="my_auto_connect_8h.html#ab8e5b92436ed19ff04454974ca9b5140" title="Timeout to search WiFi already configured. (150000ms=2.5min)">WIFI_REBOOT_TIMEOUT</a> set Timeout to search WiFi already configured</li>
</ul>
</li>
<li>in the file <a class="el" href="create__json_8h.html" title="Create JSON string out of given values.">create_json.h</a><ul>
<li><a class="el" href="create__json_8h.html#ab1d2a71062488a1b8d2f9129682a42b9" title="Software version of the crowdsensor for json messages.">SOFTWARE_VERSION</a> Software version of the crowdsensor</li>
</ul>
</li>
<li>in the file <a class="el" href="sensor_8h.html" title="variable and definitions for sensors">sensor.h</a><ul>
<li><a class="el" href="sensor_8h.html#a661d236dd49f3aef3a2cf46cf6a1405e" title="DHT22 sensor communication pin.">DHT_PIN</a> 21, set DHT22 sensor communication pin</li>
<li><a class="el" href="sensor_8h.html#a9f6149e98e70e1d5be5f0f33921cb7d7" title="BME280 I2C Address 0x77 for Red, 0x76 for Purple (chinese)">BME_ADDR</a> 0x77, set BME280 I2C Address 0x77 for Red, 0x76 for Purple</li>
<li><a class="el" href="sensor_8h.html#ad9e594e426bce833af06dea308dbbf9a" title="BME280 I2C SDA pin.">BME_SDA</a>, set BME280 I2C SDA pin</li>
<li><a class="el" href="sensor_8h.html#a5db75d8e5f3deda546603b949c520446" title="BME280 I2C SCL pin.">BME_SCL</a>, set BME280 I2C SCL pin</li>
<li><a class="el" href="sensor_8h.html#a7130f8006502cdaa31094baa3f4dd3fa" title="SDS011 TXD pin is connected at RXD of Serial2 Object.">SDS011_TXD</a>, set SDS011 TXD pin is connected at RXD of Serial2 Object</li>
<li><a class="el" href="sensor_8h.html#ad2b404eb4de525cef31b8413f5d14b13" title="SDS011 RXD pin is connected at TXD of Serial2 Object (no need to physically connect)">SDS011_RXD</a>, set SDS011 RXD pin is connected at TXD of Serial2 Object (no need to physically connect)</li>
</ul>
</li>
<li>in the file <a class="el" href="main_8h.html" title="This the main page for the SMARTAQNET which is the core of the project.">main.h</a><ul>
<li><a class="el" href="main_8h.html#aa14dc39d52ab121ceb570f1a265385e0" title="firmware version, (for intermediate versions being actively worked on, append &quot;pre&quot; to number,...">FIRMWARE_VERSION</a> controls the hard-coded firmware version of the code</li>
<li><a class="el" href="main_8h.html#af06baee05280c189592215d5ea08e7ef" title="Software.version Name property for Thing and Datastreams.">sw_version</a> describes the software version of the Thing's software properties</li>
<li><a class="el" href="main_8h.html#acbd8a4cec684c263a6cc312c70d45ef3" title="Hardware.Revision Date property for Thing and Datastreams.">hw_date</a> describes the hardware revision timestamp of the Thing's hardware properties</li>
<li><a class="el" href="main_8h.html#acbb11c1e34784cf1e3147029f942bfd6" title="Debugging, uncomment to switch servers to release version, enable sending to madavi and luftdaten....">BASE_URL</a> HTTP Server Address</li>
<li>RELEASE controls the debugging prints and <a class="el" href="main_8h.html#a7e7232f278193dd8684f973ee70ef3f5" title="Define MYDEBUG for controlling debugging.">MY_DEBUG</a></li>
<li><a class="el" href="main_8h.html#af58473239b566ebd1187b4cc8c71e97d" title="switch for sending to FROST teco server">ENABLE_SEND2FROST</a>, set switch for sending to FROST teco server</li>
<li><a class="el" href="main_8h.html#a71a7a65f7dd7e8f3ea14942213cd8217" title="intervall of reading sensor data in ms">SENSOR_INTERVAL</a>, set intervall of reading sensor data in ms</li>
<li><a class="el" href="main_8h.html#aef6021251fa63b1e73a98864b809904e" title="intervall of showing statistics informations, it is multiple of SENSOR_INTERVAL i....">STATS_INTERVAL</a>, set intervall of showing statistical/informative screen multiple of (<a class="el" href="main_8h.html#a71a7a65f7dd7e8f3ea14942213cd8217" title="intervall of reading sensor data in ms">SENSOR_INTERVAL</a>)</li>
<li><a class="el" href="main_8h.html#a18d121e3e45bfea386799ad36fb70b5f" title="switch for sending to madavi api">ENABLE_SEND2MADAVI</a>, set switch for sending to madavi api</li>
<li><a class="el" href="main_8h.html#ace6bf58c74189bcd567c1135baaa9505" title="switch for sending to luftdaten api">ENABLE_SEND2LUFTDATEN</a>, set switch for sending to luftdaten api</li>
<li><a class="el" href="main_8h.html#a6f4b34eadf0db60197dce3a76e0d6632" title="intervall of sending to madavi api in ms">SEND2MADAVI_INTERVAL</a>, set intervall of sending to madavi api in ms</li>
<li><a class="el" href="main_8h.html#a7a63477c73052322ebb3ea6f1bfe7e1d" title="intervall of sending to madavi api in ms">SEND2LUFTDATEN_INTERVAL</a>, set intervall of sending to madavi api in ms</li>
<li><a class="el" href="main_8h.html#a18bdfe88e9f5895863740df7ad801109" title="enable daily reboot at specific time">ENABLE_DAILY_REBOOT</a>, set enable daily reboot at specific time</li>
<li><a class="el" href="main_8h.html#a423126ae538bf9e83239e46e46cf1df9" title="set time when to do daily reboot (hour of time of day for reboot goes here) //TODO set proper time">TIMETOREBOOT</a>, set time when to do daily reboot (hour of time of day for reboot goes here) //TODO set proper time</li>
<li><a class="el" href="main_8h.html#a8a1756fdd61bca61d188ce01ece876b9" title="intervall of auto reboot while in access point mode (config mode) in ms (600000ms is 10min)....">APMODE_REBOOT_TIMEOUT</a>, set intervall of auto reboot while in access point mode (config mode) in ms (6000000ms is 10min). autoreboot while in ap mode only occurs if no device is connected to the esp32</li>
<li><a class="el" href="main_8h.html#ad8124687637087b9096f96b838f93400" title="Timeout for NTP timeout (s) in waitForSync()">NTP_TIMEOUT_WAIT</a>, set Timeout for NTP timeout (s) in waitForSync()</li>
<li><a class="el" href="main_8h.html#a953ca2c42ce0015ef8c2965e3b395100" title="Specified the offset if the user data exists.">CREDENTIAL_OFFSET</a>, Specified the NVS offset if the user data exists.</li>
<li><a class="el" href="main_8h.html#aa585e8beebc12dba62dbdc15b8cf1f71" title="url for public domain">data1_url_cc0</a> defines the Smart AQnet Licese for public domain</li>
<li><a class="el" href="main_8h.html#a35c49e7e622aac3342eabee213dd4bfc" title="url for license property">data1_url_ccby</a> defines the Smart AQnet Licese property</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="prereq"></a>
Pre-requisites</h1>
<ol type="1">
<li>Arrange the required <a class="el" href="index.html#hw_sec">Hardware</a> and carry out the <a class="el" href="index.html#wiring">Wirings</a>.</li>
<li>Install the the <a class="el" href="index.html#arduinoide">Arduino IDE</a></li>
<li>Install the <a class="el" href="index.html#boardlib">ESP32 Arduino core</a></li>
<li>Install the recommended <a class="el" href="index.html#lib">Required Libraries</a></li>
</ol>
<h1><a class="anchor" id="hw_sec"></a>
Hardware</h1>
<p>It consists of ESP32 microcontrollers, which is "HelTec WiFi Kit 32" -&mdash;&gt; <a href="https://heltec.org/project/wifi-kit-32/">https://heltec.org/project/wifi-kit-32/</a> Following board, hardware and libraries are used to develop this project.</p>
<h2><a class="anchor" id="peri"></a>
Peripherals</h2>
<ol type="1">
<li>OLED Built-in OLED Display -&mdash;&gt; <a href="https://heltec.org/project/wifi-kit-32/">https://heltec.org/project/wifi-kit-32/</a></li>
<li>SDS011 Sensor -&mdash;&gt; <a href="https://learn.watterott.com/sensors/sds011/">https://learn.watterott.com/sensors/sds011/</a></li>
<li>BME280 Sensor for Humidity and Temperature -&mdash;&gt; <a href="https://www.ebay.de/itm/3-3V-Bosch-BME280-Barometer-Luftdruck-Luftfeuchte-Sensor-Modul-BMP280-SPI-I2C-/263548911232">https://www.ebay.de/itm/3-3V-Bosch-BME280-Barometer-Luftdruck-Luftfeuchte-Sensor-Modul-BMP280-SPI-I2C-/263548911232</a> or <a href="https://eckstein-shop.de/SparkFun-Barometric-Pressure-Sensor-Breakout-MPL115A1?curr=EUR&gclid=Cj0KCQjww7HsBRDkARIsAARsIT6QsuuszbyaQ4r1DLuYTOT5pgwMfpIhRTtwQKAA2vtHkuHGrBZa9JQaAo-gEALw_wcB">https://eckstein-shop.de/SparkFun-Barometric-Pressure-Sensor-Breakout-MPL115A1?curr=EUR&amp;gclid=Cj0KCQjww7HsBRDkARIsAARsIT6QsuuszbyaQ4r1DLuYTOT5pgwMfpIhRTtwQKAA2vtHkuHGrBZa9JQaAo-gEALw_wcB</a></li>
<li>DHT22 Sensor for Temperature and Humidity -&mdash;&gt; <a href="https://www.sparkfun.com/products/10167">https://www.sparkfun.com/products/10167</a></li>
</ol>
<h2><a class="anchor" id="arduinoide"></a>
Arduino IDE</h2>
<p>The Arduino IDE Version 1.8 or later is needed. Please install from the official Arduino IDE download page. This step is not required if you already have the most recent version.</p>
<h3><a class="anchor" id="dialout"></a>
Pyserial</h3>
<p>If you use linux, you have to install the python pyserial package and add the current user to the dialout group: </p><pre><code class="text">
 sudo apt install python-pip
 pip install pyserial
 sudo /usr/sbin/usermod -a -G dialout &lt;MY_USER_NAME&gt;
 </code></pre><h3><a class="anchor" id="boardlib"></a>
ESP32 Arduino core</h3>
<p>Also, to apply AutoConnect to ESP32, the arduino-esp32 core provided by Espressif is needed. Stable 1.0.3 or required and the latest release is recommended. Install third-party platform using the Boards Manager of Arduino IDE (for instructions see here: <a href="https://github.com/espressif/arduino-esp32/blob/master/docs/arduino-ide/boards_manager.md">https://github.com/espressif/arduino-esp32/blob/master/docs/arduino-ide/boards_manager.md</a>). You can add multiple URLs into Additional Board Manager URLs field, separating them with commas. Package URL is <a href="https://dl.espressif.com/dl/package_esp32_index.json">https://dl.espressif.com/dl/package_esp32_index.json</a> for ESP32.</p>
<h3><a class="anchor" id="lib"></a>
Required Libraries</h3>
<p>Following are the commonly used libraries, and should be added in the Arduino IDE, before the compiling.</p><ol type="1">
<li>FIRMWARE_VERSION 0.8.6.1 onwards<ul>
<li>ESP32 Board by Espressif Systems v1.0.3 (<a href="https://github.com/espressif/arduino-esp32">https://github.com/espressif/arduino-esp32</a>)</li>
<li>Adafruit Unified Sensor by Adafruit v1.0.3 (<a href="https://github.com/adafruit/Adafruit_Sensor">https://github.com/adafruit/Adafruit_Sensor</a>)</li>
<li>Adafruit BME280 Library by Adafruit v1.0.8 (<a href="https://github.com/adafruit/Adafruit_BME280_Library">https://github.com/adafruit/Adafruit_BME280_Library</a>)</li>
<li>ArduinoJson by Benuit Blanchon v 6.12.0 (<a href="https://arduinojson.org/?utm_source=meta&utm_medium=library.properties">https://arduinojson.org/?utm_source=meta&amp;utm_medium=library.properties</a>) (IMPORTANT: ArduinoIDE installs the version (v6), but it doesnt work with this one.)</li>
<li>DHT sensor library by Adafruit v1.3.4 (<a href="https://github.com/adafruit/DHT-sensor-library">https://github.com/adafruit/DHT-sensor-library</a>)</li>
<li>PageBuilder by Hieromon Ikasamo v1.3.4 (<a href="https://github.com/Hieromon/PageBuilder">https://github.com/Hieromon/PageBuilder</a>)</li>
<li>eztime by Rop Gonggrijp v0.7.10 (<a href="https://github.com/ropg/ezTime">https://github.com/ropg/ezTime</a>)</li>
<li>u8g2 by oliver v2.26.14 (<a href="https://github.com/olikraus/u8g2">https://github.com/olikraus/u8g2</a>)</li>
<li>QRCode by Richard Moore v0.0.1 (<a href="https://github.com/ricmoo/qrcode/">https://github.com/ricmoo/qrcode/</a>)</li>
<li>AutoConnect by Hieromon Ikasamo v1.1.3 (<a href="https://github.com/Hieromon/AutoConnect.git">https://github.com/Hieromon/AutoConnect.git</a>)</li>
<li>name=SDS011 sensor Library by R. Zschiegner v0.0.6 (<a href="https://github.com/ricki-z/SDS011">https://github.com/ricki-z/SDS011</a>). This library is kept in src/lib/SDS011 folder. Even the library is updated on the github. But when tried to installed from library manager it is not installed properly for esp32.</li>
</ul>
</li>
<li>FIRMWARE_VERSION 0.8.6 and older<ul>
<li>Adafruit Unified Sensor by Adafruit v1.0.3 (<a href="https://github.com/adafruit/Adafruit_Sensor">https://github.com/adafruit/Adafruit_Sensor</a>)</li>
<li>Adafruit BME280 Library by Adafruit v1.0.8 (<a href="https://github.com/adafruit/Adafruit_BME280_Library">https://github.com/adafruit/Adafruit_BME280_Library</a>)</li>
<li>ArduinoJson by Benuit Blanchon v 5.13.5 (<a href="https://arduinojson.org/?utm_source=meta&utm_medium=library.properties">https://arduinojson.org/?utm_source=meta&amp;utm_medium=library.properties</a>) (IMPORTANT: ArduinoIDE installs the version (v6), but it doesnt work with this one.)</li>
<li>DHT sensor library by Adafruit v1.3.4 (<a href="https://github.com/adafruit/DHT-sensor-library">https://github.com/adafruit/DHT-sensor-library</a>)</li>
<li>PageBuilder by Hieromon Ikasamo v1.3.4 (<a href="https://github.com/Hieromon/PageBuilder">https://github.com/Hieromon/PageBuilder</a>)</li>
<li>eztime by Rop Gonggrijp v0.7.10 (<a href="https://github.com/ropg/ezTime">https://github.com/ropg/ezTime</a>)</li>
<li>u8g2 by oliver v2.25.10 (<a href="https://github.com/olikraus/u8g2">https://github.com/olikraus/u8g2</a>)</li>
<li>Autoconnect lib (is already in src folder, no need to install) [MODIFIED] [till FIRMWARE_VERSION "0.8.6 pre"]</li>
<li>SDS011 sensor Library by R. Zschiegner (already in src folder, no need to install) [MODIFIED] [till FIRMWARE_VERSION "0.8.6 pre"]</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="upload"></a>
Firmware Uploading</h2>
<p>Following steps are recommended to upload the firmware before handing over the new crowd-sensor node.</p><ol type="1">
<li>To erase flash completely before delivering the product: "C:\Users\Sajjad\Documents\ArduinoData\packages\esp32\tools\esptool_py&gt;esptool.py --chip esp32 erase_flash" from the command terminal.</li>
<li>Upload the firmware using the Ardiuno IDE</li>
</ol>
<h1><a class="anchor" id="wiring"></a>
Wirings</h1>
<ol type="1">
<li>OLED Display (built-in)<br />
 The display is built-in already with the ESP32 board through I2C. The I2C address is 0x3c, SDA pin is 4, SCL pin is 15, and RST pin is 16. They are already connected. The custom fonts are generated using online Font Generatore from -&mdash;&gt; <a href="http://oleddisplay.squix.ch/#/home">http://oleddisplay.squix.ch/#/home</a>. Don't need hardware wiring, just require pin definitions, as:<ul>
<li><a class="el" href="main_8h.html#ac5d957e4fd3dc11cd97a54cf9ca057a4" title="Reset PIN of OLED Module.">RST</a>, set Reset PIN of OLED Module</li>
<li><a class="el" href="main_8h.html#a7dfa2c4cfbfcba36416046052e7943e8" title="The I2C address of the SSD1306 OLDE.">OLED_ADDR</a>, The I2C address of the SSD1306 OLDE</li>
<li><a class="el" href="main_8h.html#afbf31d4d5bad7fd61418b8b8036df96c" title="The SDA pin of the SSD1306 OLDE.">OLED_SDA</a>, The SDA pin of the SSD1306 OLDE</li>
<li><a class="el" href="main_8h.html#ad3ddbbb48cad4c34406916e199b89122" title="The SCL pin of the SSD1306 OLDE.">OLED_SCL</a>, The SCL pin of the SSD1306 OLDE</li>
</ul>
</li>
<li>SDS011 Dust Sensor<br />
 One has to:<ul>
<li>connect TXD of Dust Sensor SDS011 to Pin 13 of ESP32 (ESP-RX)</li>
<li>connect 5V of Dust Sensor SDS011 to Pin 5V of ESP32</li>
<li>connect GND of Dust Sensor SDS011 to Pin GND of ESP32</li>
</ul>
</li>
<li>BME280 Sensor for Humidity and Temperature<br />
<ul>
<li>connect SCK of BME280 sensor to Pin 22 of ESP32 (ESP-SCL)</li>
<li>connect SDA of BME280 sensor to Pin 21 of ESP32 (ESP-SDA)</li>
<li>connect VCC of BME280 sensor to 3V3 of ESP32</li>
<li>connect GND of BME280 sensor to GND of ESP32</li>
<li>the I2C address for different BME280 (purple/red) can be configure in <a class="el" href="sensor_8h.html" title="variable and definitions for sensors">sensor.h</a> using <a class="el" href="sensor_8h.html#a9f6149e98e70e1d5be5f0f33921cb7d7" title="BME280 I2C Address 0x77 for Red, 0x76 for Purple (chinese)">BME_ADDR</a> constant</li>
</ul>
</li>
<li>DHT22 Sensor for Temperature and Humidity (if BME280 is not used)<br />
 Look at the sensor from the front (grid shows in your direction), put the pins facing down, start counting the pins from left (pin1) to right (pin4). pin 3 is not connected.<br />
 One has to:<ul>
<li>Connect pin 1 of DHT22 sensor (on the left) to 3V3 of ESP32</li>
<li>Connect pin 2 of DHT22 sensor to Pin 21 of ESP32 (data)</li>
<li>Connect pin 4 of DHT22 sensor (on the right) to GND of ESP32</li>
<li>Connect a resistor in range 4.7k to 10k from pin 2 (data) to pin 1 (power) of the sensor</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="knownbugs"></a>
Known Bugs</h1>
<p>There are following bugs and discrepensies that needs to be take care off.</p><ol type="1">
<li>The config page sometimes takes quite long to load (esp. on a mobile phone). Patience needed!!!</li>
<li>Sometimes, the AutoConnect does not recover the earlier configured credentials after the reset. This is happend in rare situations with some internet routers. Similar issure reported at: <a href="https://github.com/espressif/arduino-esp32/issues/1464">https://github.com/espressif/arduino-esp32/issues/1464</a></li>
<li>Sometimes, the EZTime Library can not synchronize with the internet time. This is happend rarely. Sometime, increasing <a class="el" href="main_8h.html#ad8124687637087b9096f96b838f93400" title="Timeout for NTP timeout (s) in waitForSync()">NTP_TIMEOUT_WAIT</a> constant's time, may solve the issue. Similar issue is reported at: <a href="https://github.com/ropg/ezTime/issues/40">https://github.com/ropg/ezTime/issues/40</a></li>
<li>Sometimes, while posting different observations to a server, there are some postings shows negative http status, like: HTTPC_ERROR_CONNECTION_REFUSED (-1) and HTTPC_ERROR_READ_TIMEOUT (-11) as traced in the HTTPClient library. This means, when there is -1 HTTP Status, then the observation is not being posted. Following are some tests that shows the percentage of these errors.<ol type="a">
<li><b>Duration</b>:<br />
 From 2020-01-19T03:02:38.000Z to 2020-01-20T04:14:02.000Z<br />
 Result: 1 day, 1 hour, 11 minutes and 24 seconds= 90,684 seconds<br />
 <b>Analysis</b>:<br />
 Reset occurrences: 3 i.e. routine resets at 4:00<br />
 [API] Post Observation... counts 43429 i.e. 8685.8 observation set of five<br />
 [API] HTTP Code: -1x counts 339<br />
 i.e. 339/43429x100=0.78%<br />
</li>
<li><b>Duration</b>:<br />
 From 2020-01-22T09:34:19.000Z to 2020-01-25T00:03:57.000Z<br />
 Result: 2 days, 14 hours, 29 minutes and 38 seconds = 224,978 seconds<br />
 <b>Analysis</b>:<br />
 Reset occurrences: 2 i.e. routine resets at 4:00<br />
 [API] Post Observation... counts 111655<br />
 [API] HTTP Code: -1x counts 198<br />
 i.e. 198/111655x100 = 0.17%<br />
</li>
<li><b>Duration</b>:<br />
 From 2020-01-26T22:17:08.000Z to 2020-01-27T20:01:32.000Z<br />
 Result: 21 hours, 44 minutes and 24 seconds=78,264 seconds<br />
 <b>Analysis</b>:<br />
 Reset occurrences: 1 i.e. routine resets at 4:00<br />
 [API] Post Observation... counts 38645<br />
 [API] HTTP Code: -1x counts 149<br />
 i.e. 149/38645x100 = 0.38%<br />
</li>
<li><b>Duration</b>:<br />
 From 2020-01-28T21:01:21.000Z to 2020-01-30T11:58:11.000Z<br />
 Result: 1 day, 14 hours, 56 minutes and 50 seconds=140,210 seconds<br />
 <b>Analysis</b>:<br />
 Reset occurrences: 2 i.e. routine resets at 4:00<br />
 [API] Post Observation... counts 69315<br />
 [API] HTTP Code: -1x counts 225<br />
 i.e. 225 / 69315 x 100 = 0.32%<br />
</li>
<li><b>Duration</b>:<br />
 From 2020-02-13T18:45:43.000Z to 2020-02-15T16:52:03.000Z<br />
 Result: 1 day, 22 hours, 6 minutes and 20 seconds = 165,980 seconds<br />
 <b>Analysis</b>:<br />
 Reset occurrences: 2 i.e. routine resets at 4:00<br />
 [API] Post Observation... counts 80725<br />
 [API] HTTP Code: -1x counts 191<br />
 i.e. 191 / 80725 x 100 = 0.22%<br />
</li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="testing"></a>
Some Observations</h2>
<ol type="1">
<li>I tested it with long testing. And had the following observations (Ticket#2157).<ul>
<li>From "phenomenonTime":"2019-12-31T01:29:44.000Z" to "phenomenonTime":"2019-12-31T17:37:14.000Z". There has been only 27 counts for "[API] HTTP Code: -"</li>
<li>Then, there is an interruption on the internet. I noticed that my browser was not responding and there continuous -1 or -11 error.</li>
<li>There has been 64 counts for "[API] HTTP Code: -" i.e. another 37 counts just between "phenomenonTime":"2019-12-31T17:37:24.000Z" and "phenomenonTime":"2019-12-31T17:43:13.000Z".</li>
<li>The queries [<a class="el" href="main_8h.html#acbb11c1e34784cf1e3147029f942bfd6" title="Debugging, uncomment to switch servers to release version, enable sending to madavi and luftdaten....">BASE_URL</a>]/Datastreams('saqn%3Ads%3Ace4fe57')/Observations?$count=True&amp;$filter=phenomenonTime%20ge%202019-12-31T01:29:44.000Z%20and%20phenomenonTime%20le%202019-12-31T02:03:53.000Z&amp;$orderby=phenomenonTime%20desc gives 205 count.</li>
<li>The queries [<a class="el" href="main_8h.html#acbb11c1e34784cf1e3147029f942bfd6" title="Debugging, uncomment to switch servers to release version, enable sending to madavi and luftdaten....">BASE_URL</a>]/Datastreams('saqn%3Ads%3A6d3c4e7')/Observations?$count=True&amp;$filter=phenomenonTime%20ge%202019-12-31T01:29:44.000Z%20and%20phenomenonTime%20le%202019-12-31T02:03:53.000Z&amp;$orderby=phenomenonTime%20desc gives 204 count, there was [API] HTTP Code: -1.</li>
<li>This means, when there is -1 HTTP Status, then the observation is not being posted. When traced the HTTPClient library for -1 or -11, it shows:<ol type="a">
<li>HTTPC_ERROR_CONNECTION_REFUSED (-1)</li>
<li>HTTPC_ERROR_READ_TIMEOUT (-11)</li>
</ol>
</li>
</ul>
</li>
<li>Just carried the test and judged how many times there is HTTP CODE: -1 (Ticket#2185).<ul>
<li>Duration:<ul>
<li>Start: 2020-01-19T03:02:38 and End: 2020-01-20T04:14:02</li>
<li>Alternative time units: 1 day, 1 hour, 11 minutes and 24 seconds can be converted to one of these units: 90,684 seconds</li>
</ul>
</li>
<li>Analysis:<ul>
<li>Reset occurrences: 3 i.e. routine resets at 4:00</li>
<li>ideally it should be around 9068 observation set of five, searchig the following in an Editor shows:<ol type="a">
<li>"[API] Post Observation..." counts 43429 i.e. 8685.8 observation set of five</li>
<li>"[API] HTTP Code: -1" counts 339 i.e. 339/43429x100=0.0078%</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="changelog"></a>
Change Log</h1>
<h2><a class="anchor" id="changelog2"></a>
FIRMWARE_VERSION 0.8.6.1 onwards</h2>
<ul>
<li>[0.8.7.0] Mar. 28, 2020<ul>
<li>add an extra html page that is indirectly accessed using <a href="http://">http://</a>[HOME-IP]/dummy. This is not visible in the menues.</li>
</ul>
</li>
<li>[0.8.7.0] Mar. 11, 2020<ul>
<li>Showing error as E00. Also separate Error Decoding section is added explaining different errors.</li>
<li>software version is not now saved in eeprom.</li>
<li>license patching bug fix. now it is implemented as: if any of "name" and "legal_notice" is changed, the license is patched with new "name", "legal_notice" and "url".</li>
<li>get_value("user_data", "rht_sensor") is used to read rht_sensor values frequently, just dit this at the begining and save it to "rhtSensor"</li>
<li>more introduction text, added logo to Latex title page by adding custom headers, removal of "Generated by Doxygen" from refman.tex manually</li>
</ul>
</li>
<li>[0.8.7.0] Mar. 07, 2020<ul>
<li><a class="el" href="create__json_8h.html#ab1d2a71062488a1b8d2f9129682a42b9" title="Software version of the crowdsensor for json messages.">SOFTWARE_VERSION</a> in <a class="el" href="create__json_8h.html" title="Create JSON string out of given values.">create_json.h</a> is updated and sync with <a class="el" href="main_8h.html#aa14dc39d52ab121ceb570f1a265385e0" title="firmware version, (for intermediate versions being actively worked on, append &quot;pre&quot; to number,...">FIRMWARE_VERSION</a></li>
<li>updated the doxygen with Known bugs</li>
<li>license patching is implemented now. If the License is not there or if it is in the old form, it is patched.</li>
<li>use the current timestamp (=date of installation or date of first booting) for software.version</li>
<li>adjust error code and ID on the same line</li>
<li>bug fix to show QR while creating entities and whether it is successful or not</li>
</ul>
</li>
<li>[0.8.7.0] Mar. 01, 2020<ul>
<li>handle client is bring out of the statemachine, Alternative QR code screens for ID (in AP mode) and for IP (in Wifi connected), interval can be controlled using different constants. Contrast is controlled.</li>
</ul>
</li>
<li>[0.8.7.0] Feb. 24, 2020<ul>
<li>changing bit position of errors according to harwdare/software types, use multiple screens for release version only,</li>
<li>cleaning code and removing extra variables and expressions etc. update the flowchart and documentation</li>
</ul>
</li>
<li>[0.8.7.0] Feb. 20, 2020<ul>
<li>adding the recent features into SM Flowchart and into create entities flowchart.</li>
<li>avoid using long paths, and setting it to use relative path in doxygen html/latex (STRIP_FROM_PATH).</li>
<li>License type=&gt;name, owner=&gt;legal_notice, metadata=&gt;url in the json messages, and Lizenz=&gt; Lizenz Name, Name=&gt;Legal Notice in the html configuration page</li>
<li>fixing "Lizenz Name", "Legal Notice" split on different lines. bold, italic, strong</li>
</ul>
</li>
<li>[0.8.7.0] Feb. 18, 2020<ul>
<li>cleaned extra constant and variables from timer_definition.h, made interrupt based inetervals to balance screen timings</li>
<li>added images into doxygen html, generated doxygen latex and then pdf</li>
</ul>
</li>
<li>[0.8.7.0] Feb. 14, 2020<ul>
<li>ESP32 board version 1.0.4 downgraded to 1.0.3, as the earlier was having problem with mDNS.</li>
<li>added integer save and read function from eeprom</li>
<li>There are two screens that are toggled with the interval of 5sec: 1.Normal Screen 2. Statistical Screen</li>
</ul>
</li>
<li>[0.8.7.0] Jan. 19, 2020<ul>
<li>modeling new nomenclature, blinking HTTP server error but only at the begining, patching things properties, posting observations with /Datastreams('iotId')/Observations</li>
</ul>
</li>
<li>[0.8.7.0] Jan. 12, 2020<ul>
<li>adding 3rd parameter to <a class="el" href="main_8h.html#a24fe5bb6b476d220ec484ce84ee1dee4" title="Create (HTTP Post) if entities does exist and patch (HTTP Patch) if it already exists.">createOrUpdateEntities()</a>, if true will patch the created entities otherwise just create it. only datastreams are patched.</li>
<li>instead of using repeated checks for 200 &amp; 201 code, just copy it inside individiual funstions.</li>
<li>Changes the QRCode=ID, Changes Frost Manager Initialising, Updating AutoConnect 1.1.3</li>
</ul>
</li>
<li>[0.8.7.0] Jan. 3, 2020<ul>
<li>integrating u8g2 and u8x8 unseccessful, using u8g2 for suitable text FONT and QR code generation, including logos KIT,TECO, showing QR code.</li>
<li>using alternative oled and QR code libraries, u8g2: (<a href="https://github.com/olikraus/u8g2">https://github.com/olikraus/u8g2</a>), QRcode: (<a href="https://github.com/ricmoo/qrcode/">https://github.com/ricmoo/qrcode/</a>).</li>
</ul>
</li>
<li>[0.8.7.0] Dec. 29, 2019<ul>
<li>introducing the common DEBUG controll using <a class="el" href="main_8h.html#a5e9ff2a0401c64386c0b7277b07063cf" title="Define MY_DEB() for controlling serial.print debugging.">MY_DBG()</a></li>
<li>for HTTP Error Code 404, making consistent check for different "Nothing found." response from different servers</li>
</ul>
</li>
<li>[0.8.7.0] Dec. 24, 2019<ul>
<li>first version of deFrosting the esp32-thingsapi, looking into API code and catching up all JSON message and converting into strings without using ArduinoJSON.</li>
<li>fixing http error for different entities while creating and posting and gaurentying no error, test different Things and Locations and how they are creating/patched.</li>
<li>added flow chart for creating entities, removed all esp32-thingsapi calls/libraries</li>
</ul>
</li>
<li>[0.8.7.0] Dec. 2, 2019<ul>
<li>added RELEASE_THINGSAPI1 &amp; RELEASE_THINGSAPI2 in esp32_thingsapi/src/workshop_instances/Release-ThingsAPI.h</li>
<li>in esp32-thingsapi, all prints are precded by [API] to differtiate from other debugging statements</li>
<li>updated eztime library to 0.8.2, used eztime setInterval(10) function just before waitsync().</li>
</ul>
</li>
<li>[0.8.7.0] Nov. 1, 2019<ul>
<li>Updated Espressif from 1.0.2 to 1.0.4 and AutoConnect from 1.0.2 to 1.1.2 (Reuires changes in <a class="el" href="my_auto_connect_8h.html" title="Inherits the AutoConnect class and overrides few functions.">myAutoConnect.h</a>)</li>
<li>added initial screens around FROST initialisation</li>
<li>used "master" branch instead of "development" of submodule esp32_thingsapi</li>
</ul>
</li>
<li>[0.8.6.1] Sept. 19, 2019<ul>
<li>Adding configuration &amp; OTA pages using AutoConnectAux without Pagebuilder and fixing different issues (Sajjad)</li>
<li>cleaning all the unnessary comments, defining HW pins constants, addresses etc and documenting them. (Sajjad)</li>
<li>moved to JSON6 (by Jan)</li>
<li>fixed graphic OLED overlapping bugs because it don't have clearline() function and it clears whole display (Sajjad)</li>
<li>using BME280 RED/PURPLE by just changing address in bme(address, sda, scl) (Sajjad)</li>
<li>fixed BME280 not found problem by using another TwoWire instance Wire1 (Sajjad)</li>
<li>started doxygen documentations (Sajjad).</li>
<li>graphic based oled with qr support (Sajjad).</li>
<li>converted to state machine (Sajjad).</li>
<li>inherited AutoConnect to use custom code (Sajjad).</li>
<li>added NTP sync timeout (Sajjad).</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="log1"></a>
FIRMWARE_VERSION 0.8.6 and older</h2>
<p>change history (since version 0.8)</p><ul>
<li>[0.8.1]<ul>
<li>bugfix for coordinates: switched to coordinates[]={long, lat...}</li>
</ul>
</li>
<li>[0.8.2]<ul>
<li>added hack for HTTP patch for location</li>
<li>removed all libs from src folder that are used in its original state and included the libs directly in arduino</li>
<li>updated SDS011 lib to newest version</li>
<li>changed display font</li>
<li>added over the air update support</li>
<li>added mDNS: now esp32.local can be typed into browser to connect to esp32</li>
</ul>
</li>
<li>[0.8.3]<ul>
<li>bugfix for error that no reboot occured after timeout in ap mode</li>
<li>bugfix for wrong display message if no RH T sensor is configured</li>
<li>bugfix for wrong display message if Wifi is searched</li>
<li>improved display messages</li>
<li>bugfix for not working geocode button</li>
</ul>
</li>
<li>[0.8.4]<ul>
<li>added properties and webinterface inputs for data license</li>
<li>geocoding button does not work again, previous bugfix did not work</li>
</ul>
</li>
<li>[0.8.5]<ul>
<li>(hopefully) permanent bugfix for not working geocode button</li>
<li>added license url to webinterface</li>
<li>added RELEASE macro that can be used to switch between development and release versions (switches server addresses and supressses some serial output)</li>
<li>display shows FW version for 2 sec on startup</li>
<li>webinterface shows map to pick location</li>
<li>added reboot after saving configuration, so that thing and datastreams are patched in new <a class="el" href="esp32-stationary_8ino.html#a4fc01d736fe50cf5b977f755b675f11d" title="initialization of peripherals attached to ESP32 board">setup()</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="deb"></a>
Quick Debugging</h1>
<p>The detailed debugging can be controlled for the firmware using the constant RELEASE.</p><ol type="1">
<li>ESP32-THINGSAPI DEBUGGING For quick debugging of different functionality and parts of the code, we can use following quick tricks for debugging. Defined a constant i.e. RELEAS_THINGSAPI1 &amp; RELEAS_THINGSAPI2 in the file <a class="el" href="main_8h.html" title="This the main page for the SMARTAQNET which is the core of the project.">main.h</a>, for more detailed or more important respectively.<br />
 uncomment <a class="el" href="main_8h.html#a7e7232f278193dd8684f973ee70ef3f5" title="Define MYDEBUG for controlling debugging.">MY_DEBUG</a> to supress debugg messages (otherwise will print more detailed)<br />
 All prints are precded by [API] to differtiate from other debugging statements</li>
<li>Use Short Timeouts<ul>
<li><a class="el" href="main_8h.html#a8a1756fdd61bca61d188ce01ece876b9" title="intervall of auto reboot while in access point mode (config mode) in ms (600000ms is 10min)....">APMODE_REBOOT_TIMEOUT</a> 3600000=10min (default). This is intervall of auto reboot while in access point mode. Try with 1min for debugging</li>
<li><a class="el" href="main_8h.html#ad8124687637087b9096f96b838f93400" title="Timeout for NTP timeout (s) in waitForSync()">NTP_TIMEOUT_WAIT</a>=60s. Timeout for NTP timeout in waitForSync(), try 20s</li>
<li><a class="el" href="my_auto_connect_8h.html#ab8e5b92436ed19ff04454974ca9b5140" title="Timeout to search WiFi already configured. (150000ms=2.5min)">WIFI_REBOOT_TIMEOUT</a>=150000=2.5min, Timeout to search WiFi already configured. Try with 1min for debugging</li>
</ul>
</li>
<li>Sending data without JSON error: To test some functionality, like AutoConnect, Wifi, EEPROM, Timeouts etc, uploading is not required, one can skip it.<br />
 <pre><code class="c">
    case check_location_data:
       // only send if position data is given
       //if (enable_send2frost &amp;&amp;  (get_value("user_data", "latitude") != ""))
       //{
       //  Serial.println("position data is given, start sending");
       //  state = check_timesync;
       //}else
         state = handle_client;
       break;
 </code></pre></li>
<li>ByPassing Save Credentials: One can use the manual WiFi to quickly run the code. Put the following in the <a class="el" href="esp32-stationary_8ino.html#a4fc01d736fe50cf5b977f755b675f11d" title="initialization of peripherals attached to ESP32 board">setup()</a><br />
 <pre><code class="c">
  WiFi.begin("WG21", "Pakistan1");//Sajjad Debugging
 </code></pre></li>
<li>Testing Webpage &amp; Avoid changing data: One can fix the eeprom data by putting the following code in the <a class="el" href="esp32-stationary_8ino.html#a4fc01d736fe50cf5b977f755b675f11d" title="initialization of peripherals attached to ESP32 board">setup()</a><br />
 <pre><code class="c">
 set_value("user_data", "address", "");       //inputAddress
 set_value("user_data", "latitude", "");       //inputLon
 set_value("user_data", "longitude", "");      //inputLat
 set_value("user_data", "rht_sensor", "default");  //inputRhtsensor
 set_value("user_data", "sds011id", "");       //inputSds011id
 set_value("user_data", "data_license", "CC BY 4.0");//inputLicense
 set_value("user_data", "data_owner", "");     //inputOwner
 </code></pre></li>
<li>If the storage space is too small when compiling, change it in arduino IDE:<br />
 Tools -&gt; board -&gt; select ESP32 DEV Module<br />
 Tools -&gt; partition scheme -&gt; No OTA (large APP)<br />
 </li>
</ol>
<h1><a class="anchor" id="author"></a>
Author(s)</h1>
<ul>
<li>Jan Formanek,</li>
<li>Sajjad Hussain,</li>
<li>Matthias Budde,</li>
</ul>
<p>The team at TECO (www.teco.edu) and at Chair for Pervasive Computing Systems (<a href="https://pcs.tm.kit.edu">https://pcs.tm.kit.edu</a>).</p>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>This code belongs to TECO www.teco.edu and must be reffered when used. BSD license, all text here must be included in any redistribution. </p>
<h2><a class="anchor" id="ack"></a>
Acknowledgments</h2>
<p>The following libraries were used:<br />
</p><ul>
<li>Espressif Systems: Licenses and Copyright 2015-2016 Espressif Systems (Shanghai) PTE LTD</li>
<li>ArduinoJson is licensed under the MIT License. <a href="https://arduinojson.org/">https://arduinojson.org/</a></li>
<li>Adafruit BME280 is licensed under Adafruit. <a href="https://adafruit.com/">https://adafruit.com/</a></li>
<li>DHT sensor is licensed under Adafruit. <a href="https://adafruit.com/">https://adafruit.com/</a></li>
<li>AutoConnect is licensed under the MIT License. <a href="https://github.com/Hieromon/AutoConnect">https://github.com/Hieromon/AutoConnect</a></li>
<li>QRCode by Richard Moore is licensed under the MIT License <a href="https://github.com/ricmoo/QRCode/blob/master/LICENSE.txt">https://github.com/ricmoo/QRCode/blob/master/LICENSE.txt</a></li>
<li>ezTime is licensed under the MIT License. <a href="https://github.com/ropg/ezTime">https://github.com/ropg/ezTime</a></li>
<li>PageBuilder is licensed under the MIT License. <a href="https://github.com/Hieromon/PageBuilder">https://github.com/Hieromon/PageBuilder</a></li>
<li>U8g2 is licensed under the MIT License. <a href="https://github.com/olikraus/u8g2">https://github.com/olikraus/u8g2</a></li>
<li>SDS011 sensor Library is licensed under the MIT License. (<a href="https://github.com/ricki-z/SDS011">https://github.com/ricki-z/SDS011</a>)</li>
</ul>
<h2><a class="anchor" id="mit"></a>
MIT License</h2>
<pre class="fragment">   Copyright (c) 2017-2019 Hieromon Ikasamo

   Permission is hereby granted, free of charge, to any person obtaining a copy
   of this software and associated documentation files (the "Software"), to deal
   in the Software without restriction, including without limitation the rights
   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   copies of the Software, and to permit persons to whom the Software is
   furnished to do so, subject to the following conditions:

   The above copyright notice and this permission notice shall be included in all
   copies or substantial portions of the Software.

   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   SOFTWARE.
</pre><h2><a class="anchor" id="u8gLic"></a>
U8g2lib License</h2>
<pre class="fragment">   The U8g2lib code (http://code.google.com/p/u8g2/) is licensed under the terms of 
   the new-bsd license (two-clause bsd license).
   See also: http://www.opensource.org/licenses/bsd-license.php

   The repository and optionally the releases contain icons, which are
   derived from the WPZOOM Developer Icon Set:
   http://www.wpzoom.com/wpzoom/new-freebie-wpzoom-developer-icon-set-154-free-icons/
   WPZOOM Developer Icon Set by WPZOOM is licensed under a Creative Commons 
   Attribution-ShareAlike 3.0 Unported License.

   Fonts are licensed under different conditions.
   See  https://github.com/olikraus/u8g2/wiki/fntgrp
   for detailed information on the licensing conditions for each font. 
</pre><h2><a class="anchor" id="EspressifLic"></a>
Espressif Systems License</h2>
<pre class="fragment">   Copyright 2015-2016 Espressif Systems (Shanghai) PTE LTD

   Licensed under the Apache License, Version 2.0 (the "License");    
   you may not use this file except in compliance with the License.    
   You may obtain a copy of the License at    
   http://www.apache.org/licenses/LICENSE-2.0    
   Unless required by applicable law or agreed to in writing, software    
   distributed under the License is distributed on an "AS IS" BASIS,    
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    
   See the License for the specific language governing permissions and    
   limitations under the License.
</pre><dl class="section date"><dt>Date</dt><dd>19.08.2019 </dd></dl>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
